<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.taikang.health.timer.scheduled.dao.QuartzDao">

    <!--新增组信息-->
    <insert id="addJob" parameterType="com.taikang.health.timer.scheduled.bo.QuartzBo"  useGeneratedKeys="true" keyProperty="id">
		INSERT  INTO  quartz (id,job_name,class_name,state,job_cron,create_time)
		values(#{id},#{jobName},#{className},#{state},#{jobCron},#{createTime})
	</insert>

    <resultMap id="QuartzBoMap" type="com.taikang.health.timer.scheduled.bo.QuartzBo">
        <id property="id" column="id" javaType="String" jdbcType="VARCHAR"/>
        <result property="jobName" column="job_name" javaType="String" jdbcType="VARCHAR"/>
        <result property="className" column="class_name" javaType="String" jdbcType="VARCHAR"/>
        <result property="state" column="state" javaType="Integer" jdbcType="VARCHAR"/>
        <result property="jobCron" column="job_cron" javaType="String" jdbcType="VARCHAR"/>
        <!--<result property="createTime" column="create_time" javaType="Date" jdbcType="VARCHAR"/>-->
    </resultMap>

    <select id="queryQuartzBoList" parameterType="com.taikang.health.timer.scheduled.bo.QuartzBo" resultMap="QuartzBoMap">
        select * from quartz
        where 1=1
        <if test="isOpen != '' and isOpen != null">
            and state=1
        </if>
        <if test="jobName != '' and jobName != null">
            and job_name like '%${jobName}%'
        </if>
        order by create_time desc
    </select>
    <select id="queryQuartzBoAll" parameterType="java.util.Map" resultMap="QuartzBoMap">
        select * from quartz
        where 1=1
        <if test="isOpen != '' and isOpen != null">
            and state=1
        </if>
        <if test="jobName != '' and jobName != null">
            and job_name like '%${jobName}%'
        </if>
        order by create_time desc
    </select>

    <!--修改-->
    <update id="modifyJob" parameterType="com.taikang.health.timer.scheduled.bo.QuartzBo">
        update quartz
        <trim prefix="SET" suffixOverrides="," suffix=" where id= #{id} ">
            <if test="jobName != '' and jobName != null">job_name=#{jobName},</if>
            <if test="className != '' and className != null">class_name=#{className},</if>
            <if test="jobCron != '' and jobCron != null">job_cron=#{jobCron},</if>
            create_time=#{createTime}
        </trim>
    </update>

    <!--修改任务状态-->
    <update id="modifyJobState">
        update quartz
        <trim prefix="SET" suffixOverrides="," suffix=" where id= #{id} ">
            state=#{state}
        </trim>
    </update>

    <!--删除-->
    <delete id="removeJob" parameterType="java.lang.String" >
		delete  from quartz where id= #{id}
	</delete>


    <!--根据ID查询-->
    <select id="getQuartzBoById" parameterType="java.lang.String" resultMap="QuartzBoMap">
		SELECT * from quartz a where a.id=#{id}
	</select>
</mapper>