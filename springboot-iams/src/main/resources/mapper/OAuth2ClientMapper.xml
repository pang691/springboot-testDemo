<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://www.mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.taikang.health.iams.dao.OAuth2ClientDao">

    <resultMap id="OAuth2ClientResultMap" type="com.taikang.health.iams.po.OAuth2Client">
        <id property="id" column="client_id" javaType="string" jdbcType="VARCHAR"/>
        <result property="name" column="name" javaType="String" jdbcType="VARCHAR"/>
        <result property="secret" column="secret" javaType="String" jdbcType="VARCHAR"/>
        <result property="remark" column="remark" javaType="String" jdbcType="VARCHAR"/>
        <result property="status" column="status" javaType="int" jdbcType="INTEGER"/>
        <result property="clientType" column="client_type" javaType="int" jdbcType="INTEGER"/>
    </resultMap>

    <!---========================自定义查询放置下方========================-->
    <!--自定义查询-->
    <select id="getClientsByUserId" parameterType="java.lang.String" resultMap="OAuth2ClientResultMap">
        SELECT
        ur.`client_id`,
        ur.`name`,
        ur.status,
        ur.client_type
        FROM    autz_user u
        INNER JOIN autz_user_client r    ON u.`user_id` = r.`user_id`
        INNER JOIN security_client  ur   ON r.`client_id` = ur.`client_id`
        WHERE u.`user_id` = #{userId}
        AND u.`enable` = 1  AND ur.`status` = 1
    </select>
    <select id="selectSingle" parameterType="com.taikang.health.iams.po.OAuth2Client"
            resultType="com.taikang.health.iams.po.OAuth2Client">
        select * from security_client where client_id = #{id} and secret = #{secret} and status = #{status}
    </select>
</mapper>